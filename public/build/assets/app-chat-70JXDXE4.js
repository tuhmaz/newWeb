document.addEventListener("DOMContentLoaded",function(){(function(){const u=document.querySelector(".app-chat-contacts .sidebar-body"),h=[].slice.call(document.querySelectorAll(".chat-contact-list-item:not(.chat-contact-list-item-title)")),s=document.querySelector(".chat-history-body"),m=document.querySelector(".app-chat-sidebar-left .sidebar-body"),p=document.querySelector(".app-chat-sidebar-right .sidebar-body"),w=[].slice.call(document.querySelectorAll(".form-check-input[name='chat-user-status']")),f=$(".chat-sidebar-left-user-about"),L=document.querySelector(".form-send-message"),n=document.querySelector(".message-input"),v=document.querySelector(".chat-search-input"),y=$(".speech-to-text"),S={active:"avatar-online",offline:"avatar-offline",away:"avatar-away",busy:"avatar-busy"};function b(){s.scrollTo(0,s.scrollHeight)}function g(t,e,c,l){t.forEach(a=>{let d=a.textContent.toLowerCase();c?-1<d.indexOf(c)?(a.classList.add("d-flex"),a.classList.remove("d-none"),e++):a.classList.add("d-none"):(a.classList.add("d-flex"),a.classList.remove("d-none"),e++)}),e==0?l.classList.remove("d-none"):l.classList.add("d-none")}u&&new PerfectScrollbar(u,{wheelPropagation:!1,suppressScrollX:!0}),s&&new PerfectScrollbar(s,{wheelPropagation:!1,suppressScrollX:!0}),m&&new PerfectScrollbar(m,{wheelPropagation:!1,suppressScrollX:!0}),p&&new PerfectScrollbar(p,{wheelPropagation:!1,suppressScrollX:!0}),b(),f.length&&f.maxlength({alwaysShow:!0,warningClass:"label label-success bg-success text-white",limitReachedClass:"label label-danger",separator:"/",validate:!0,threshold:120}),w.forEach(t=>{t.addEventListener("click",e=>{let c=document.querySelector(".chat-sidebar-left-user .avatar"),l=e.currentTarget.value;c.removeAttribute("class"),Helpers._addClass("avatar avatar-xl "+S[l],c);let a=document.querySelector(".app-chat-contacts .avatar");a.removeAttribute("class"),Helpers._addClass("flex-shrink-0 avatar "+S[l]+" me-3",a)})}),h.forEach(t=>{t.addEventListener("click",e=>{h.forEach(c=>{c.classList.remove("active")}),e.currentTarget.classList.add("active")})}),v&&v.addEventListener("keyup",t=>{let e=t.currentTarget.value.toLowerCase(),c=document.querySelector(".chat-list-item-0"),l=document.querySelector(".contact-list-item-0"),a=[].slice.call(document.querySelectorAll("#chat-list li:not(.chat-contact-list-item-title)")),d=[].slice.call(document.querySelectorAll("#contact-list li:not(.chat-contact-list-item-title)"));g(a,0,e,c),g(d,0,e,l)}),L.addEventListener("submit",t=>{if(t.preventDefault(),n.value){let e=document.createElement("div");e.className="chat-message-text mt-2",e.innerHTML='<p class="mb-0 text-break">'+n.value+"</p>",document.querySelector("li:last-child .chat-message-wrapper").appendChild(e),n.value="",b()}});let q=document.querySelector(".chat-history-header [data-target='#app-chat-contacts']"),x=document.querySelector(".app-chat-sidebar-left .close-sidebar");if(q.addEventListener("click",t=>{x.removeAttribute("data-overlay")}),y.length){var i=i||webkitSpeechRecognition;if(i!=null){var r=new i,o=!1;y.on("click",function(){const t=$(this);r.onspeechstart=function(){o=!0},o===!1&&r.start(),r.onerror=function(e){o=!1},r.onresult=function(e){t.closest(".form-send-message").find(".message-input").val(e.results[0][0].transcript)},r.onspeechend=function(e){o=!1,r.stop()}})}}})()});
