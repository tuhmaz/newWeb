let F="ltr";isRtl&&(F="rtl"),document.addEventListener("DOMContentLoaded",function(){(function(){const Y=document.getElementById("calendar"),w=document.querySelector(".app-calendar-sidebar"),q=document.getElementById("addEventSidebar"),x=document.querySelector(".app-overlay"),C={Business:"primary",Holiday:"success",Personal:"danger",Family:"warning",ETC:"info"},s=document.querySelector(".offcanvas-title"),k=document.querySelector(".btn-toggle-sidebar"),l=document.querySelector("#addEventBtn"),f=document.querySelector(".btn-delete-event"),H=document.querySelector(".btn-cancel"),g=document.querySelector("#eventTitle"),r=document.querySelector("#eventStartDate"),d=document.querySelector("#eventEndDate"),h=document.querySelector("#eventURL"),c=$("#eventLabel"),o=$("#eventGuests"),b=document.querySelector("#eventLocation"),y=document.querySelector("#eventDescription"),m=document.querySelector(".allDay-switch"),S=document.querySelector(".select-all"),D=[].slice.call(document.querySelectorAll(".input-filter")),P=document.querySelector(".inline-calendar");let n,M,u=events,L=!1;const p=new bootstrap.Offcanvas(q);if(c.length){let e=function(t){return t.id?"<span class='badge badge-dot bg-"+$(t.element).data("label")+" me-2'> </span>"+t.text:t.text};var R=e;c.wrap('<div class="position-relative"></div>').select2({placeholder:"Select value",dropdownParent:c.parent(),templateResult:e,templateSelection:e,minimumResultsForSearch:-1,escapeMarkup:function(t){return t}})}if(o.length){let e=function(t){return t.id?"<div class='d-flex flex-wrap align-items-center'><div class='avatar avatar-xs me-2'><img src='"+assetsPath+"img/avatars/"+$(t.element).data("avatar")+"' alt='avatar' class='rounded-circle' /></div>"+t.text+"</div>":t.text};var G=e;o.wrap('<div class="position-relative"></div>').select2({placeholder:"Select value",dropdownParent:o.parent(),closeOnSelect:!1,templateResult:e,templateSelection:e,escapeMarkup:function(t){return t}})}if(r)var B=r.flatpickr({enableTime:!0,altFormat:"Y-m-dTH:i:S",onReady:function(e,t,a){a.isMobile&&a.mobileInput.setAttribute("step",null)}});if(d)var T=d.flatpickr({enableTime:!0,altFormat:"Y-m-dTH:i:S",onReady:function(e,t,a){a.isMobile&&a.mobileInput.setAttribute("step",null)}});function E(){const e=document.querySelector(".fc-sidebarToggle-button");for(e.classList.remove("fc-button-primary"),e.classList.add("d-lg-none","d-inline-block","ps-0");e.firstChild;)e.firstChild.remove();e.setAttribute("data-bs-toggle","sidebar"),e.setAttribute("data-overlay",""),e.setAttribute("data-target","#app-calendar-sidebar"),e.insertAdjacentHTML("beforeend",'<i class="ti ti-menu-2 ti-lg text-heading"></i>')}P&&(M=P.flatpickr({monthSelectorType:"static",inline:!0}));let i=new Calendar(Y,{initialView:"dayGridMonth",events:function(e,t){let a=function(){let v=[];return[].slice.call(document.querySelectorAll(".input-filter:checked")).forEach(I=>{v.push(I.getAttribute("data-value"))}),v}();t(u.filter(function(v){return a.includes(v.extendedProps.calendar.toLowerCase())}))},plugins:[dayGridPlugin,interactionPlugin,listPlugin,timegridPlugin],editable:!0,dragScroll:!0,dayMaxEvents:2,eventResizableFromStart:!0,customButtons:{sidebarToggle:{text:"Sidebar"}},headerToolbar:{start:"sidebarToggle, prev,next, title",end:"dayGridMonth,timeGridWeek,timeGridDay,listMonth"},direction:F,initialDate:new Date,navLinks:!0,eventClassNames:function({event:e}){return["fc-event-"+C[e._def.extendedProps.calendar]]},dateClick:function(e){let t=moment(e.date).format("YYYY-MM-DD");A(),p.show(),s&&(s.innerHTML="Add Event"),l.innerHTML="Add",l.classList.remove("btn-update-event"),l.classList.add("btn-add-event"),f.classList.add("d-none"),r.value=t,d.value=t},eventClick:function(e){(function(t){n=t.event,n.url&&(t.jsEvent.preventDefault(),window.open(n.url,"_blank")),p.show(),s&&(s.innerHTML="Update Event"),l.innerHTML="Update",l.classList.add("btn-update-event"),l.classList.remove("btn-add-event"),f.classList.remove("d-none"),g.value=n.title,B.setDate(n.start,!0,"Y-m-d"),n.allDay===!0?m.checked=!0:m.checked=!1,n.end!==null?T.setDate(n.end,!0,"Y-m-d"):T.setDate(n.start,!0,"Y-m-d"),c.val(n.extendedProps.calendar).trigger("change"),n.extendedProps.location!==void 0&&(b.value=n.extendedProps.location),n.extendedProps.guests!==void 0&&o.val(n.extendedProps.guests).trigger("change"),n.extendedProps.description!==void 0&&(y.value=n.extendedProps.description)})(e)},datesSet:function(){E()},viewDidMount:function(){E()}});i.render(),E();const V=document.getElementById("eventForm");function A(){d.value="",h.value="",r.value="",g.value="",b.value="",m.checked=!1,o.val("").trigger("change"),y.value=""}FormValidation.formValidation(V,{fields:{eventTitle:{validators:{notEmpty:{message:"Please enter event title "}}},eventStartDate:{validators:{notEmpty:{message:"Please enter start date "}}},eventEndDate:{validators:{notEmpty:{message:"Please enter end date "}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap5:new FormValidation.plugins.Bootstrap5({eleValidClass:"",rowSelector:function(e,t){return".mb-5"}}),submitButton:new FormValidation.plugins.SubmitButton,autoFocus:new FormValidation.plugins.AutoFocus}}).on("core.form.valid",function(){L=!0}).on("core.form.invalid",function(){L=!1}),k&&k.addEventListener("click",e=>{H.classList.remove("d-none")}),l.addEventListener("click",e=>{if(l.classList.contains("btn-add-event")){if(L){let a={id:i.getEvents().length+1,title:g.value,start:r.value,end:d.value,startStr:r.value,endStr:d.value,display:"block",extendedProps:{location:b.value,guests:o.val(),calendar:c.val(),description:y.value}};h.value&&(a.url=h.value),m.checked&&(a.allDay=!0),t=a,u.push(t),i.refetchEvents(),p.hide()}}else L&&(function(a){a.id=parseInt(a.id),u[u.findIndex(v=>v.id===a.id)]=a,i.refetchEvents()}({id:n.id,title:g.value,start:r.value,end:d.value,url:h.value,extendedProps:{location:b.value,guests:o.val(),calendar:c.val(),description:y.value},display:"block",allDay:!!m.checked}),p.hide());var t}),f.addEventListener("click",e=>{var t;t=parseInt(n.id),u=u.filter(function(a){return a.id!=t}),i.refetchEvents(),p.hide()}),q.addEventListener("hidden.bs.offcanvas",function(){A()}),k.addEventListener("click",e=>{s&&(s.innerHTML="Add Event"),l.innerHTML="Add",l.classList.remove("btn-update-event"),l.classList.add("btn-add-event"),f.classList.add("d-none"),w.classList.remove("show"),x.classList.remove("show")}),S&&S.addEventListener("click",e=>{e.currentTarget.checked?document.querySelectorAll(".input-filter").forEach(t=>t.checked=1):document.querySelectorAll(".input-filter").forEach(t=>t.checked=0),i.refetchEvents()}),D&&D.forEach(e=>{e.addEventListener("click",()=>{document.querySelectorAll(".input-filter:checked").length<document.querySelectorAll(".input-filter").length?S.checked=!1:S.checked=!0,i.refetchEvents()})}),M.config.onChange.push(function(e){i.changeView(i.view.type,moment(e[0]).format("YYYY-MM-DD")),E(),w.classList.remove("show"),x.classList.remove("show")})})()});
