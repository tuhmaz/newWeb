$(document).ready(function(){const r=$("#select-all-logs"),i=$("#toggle-select-all-btn"),o=$("#bulk-delete-btn"),d=$("#bulk-destroy-form"),l=$("#form-feedback");let n=!1;function c(){const s=$('input[name="selected_logs[]"]:checked').length;o.toggleClass("d-none",s===0)}function a(){i.html(n?'<i class="ri-checkbox-multiple-blank-line me-1"></i> إلغاء تحديد الكل':'<i class="ri-checkbox-multiple-line me-1"></i> تحديد الكل')}i.on("click",function(){n=!n,$('input[name="selected_logs[]"]').prop("checked",n),r.prop("checked",n),c(),a()}),$(document).on("change",'input[name="selected_logs[]"]',function(){const s=$('input[name="selected_logs[]"]').length,e=$('input[name="selected_logs[]"]:checked').length;r.prop("checked",s===e),n=s===e,c(),a()}),r.on("change",function(){n=$(this).prop("checked"),$('input[name="selected_logs[]"]').prop("checked",n),c(),a()}),o.on("click",function(){const s=[];$('input[name="selected_logs[]"]:checked').each(function(){s.push($(this).val())}),s.length!==0?confirm("هل أنت متأكد من حذف السجلات المحددة؟")&&(l.removeClass("d-none alert-danger alert-success"),$("#bulk-destroy-ids").val(s.join(",")),$.ajax({url:d.attr("action"),method:"POST",data:{_token:$('meta[name="csrf-token"]').attr("content"),ids:s.join(",")},beforeSend:function(){o.prop("disabled",!0).html('<i class="fas fa-spinner fa-spin"></i> جاري الحذف...')},success:function(e){e.success?(l.addClass("alert alert-success").html(e.message).removeClass("d-none"),setTimeout(()=>{window.location.reload()},1500)):l.addClass("alert alert-danger").html(e.message).removeClass("d-none")},error:function(e){const t=e.responseJSON?e.responseJSON.message:"حدث خطأ أثناء حذف السجلات";l.addClass("alert alert-danger").html(t).removeClass("d-none")},complete:function(){o.prop("disabled",!1).html('<i class="fas fa-trash"></i> حذف المحدد')}})):alert("الرجاء تحديد السجلات التي تريد حذفها")}),c(),a(),$(".resolve-form").on("submit",function(s){s.preventDefault();const e=$(this);$.ajax({url:e.attr("action"),method:"POST",data:e.serialize(),success:function(t){e.closest("td").html('<span class="badge bg-label-success">تم الحل</span>'),t.message},error:function(t){console.error("Error:",t),alert("حدث خطأ أثناء تحديث حالة السجل")}})})});
